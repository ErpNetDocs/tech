# Original cost calculation

This article describes how the <i>original</i> cost is defined for each store transaction (i.e., for each row of a Transaction). 

There are two ways to define it: by <i>average cost</i> and by specifying the cost in the parent document. 

Which way will be used is determined by the business process (procurement, production, transfer, sale) the Transaction is created for. It depends on other modules and their respective documents, which are the main documents in the Transaction flow. 

The <i>Cost Source</i> field defines which method is used. For more information, see <b>Goods Cost</b>.

## Average Cost

It is used when the <i>Cost Source</i> field is set to <i>Store</i>. These are usually the <b>issue</b> transactions in the store. The only <b>receipt</b> transactions with this source are generated by Reconciliations. Тo define the cost of the current transaction, the following is performed:

1. All <i>valid</i> store transactions are gathered. They are non-voided or (at least) released Transactions and contain the same product, store and enterprise company which date to before the current transaction. The order of the transactions is defined by the <i>Transaction Timestamp</i>. If there are multiple transactions with the same <i>Transaction Timestamp</i>, the <b>receipt</b> transactions are ordered before the <b>issue</b> transactions.

2. The <i>Unit Cost</i> is defined in all currencies (see <b>Goods Cost</b>) from p.1.

3. The <i>Unit Cost</i> is multiplied by the quantity in the row and the result is saved as a cost in the current transaction (in all currencies).

<b><i>Example 1:</b></i>

For a specified product, store and enterprise company, there are transactions listed below. For <b>issue</b> transactions, the average cost method is used. 

In the beginning, there are two <b>receipt</b> transactions:

- <b>receipt</b>, Timestamp: 01 Dec 2020 <b>12:45</b>, <b>4</b> PCS, total cost: <b>100</b>;

- <b>receipt</b>, Timestamp: 01 Dec 2020 <b>17:27</b>, <b>3</b> PCS, total cost: <b>61</b>.

These two transactions define the unit cost as (<b>100 + 61</b>) / (<b>4 + 3</b>) = <b>23</b>. The result is used in the next <b>issue</b> transaction:

- <b>issue</b>, Timestamp: 03 Dec 2020, <b>11:29</b>, <b>5</b> PCS, total cost: 5 * 23 = <b>115</b>;

Then, there is a <b>receipt</b> transaction:

- <b>receipt</b>, Timestamp: 04 Dec 2020 <b>15:33</b>,<b>6</b> PCS, total cost: <b>146</b>;

The average cost is (<b>100 + 61 - 115 + 146</b>) / (<b>4 + 3 - 5 + 6</b>) = <b>24</b>. This cost is used in the next <b>issue</b> transactions. Note that the first issue transaction happens at the same time as the <b>receipt</b> transaction, but the <b>receipt</b> transaction is considered before the <b>issue</b> transaction. Because of this, the cost of the <b>issue</b> transaction is affected:

- <b>issue</b>, Timestamp: 04 Dec 2020 <b>15:33</b>, <b>2</b> PCS, total cost: <b>2 * 24 = 48</b>;

- <b>issue</b>, Timestamp: 07 Dec 2020 <b>09:54</b>, <b>1</b> PCS, total cost: <b>1 * 24 = 24</b>.

This example illustrates a case where the product cost is not affected by the presence or absence of a lot. Even if different lots exist in the transactions, the cost is an average. There are products required to have individual costs for each lot (this is described in the product's definition). The principle above is then changed, and in p.1 we take into account transactions that also have a matching lot field. An empty value (no lot) is considered a valid/separate lot.

<b><i>Example 2:</b></i>

There is a <b>receipt</b> Transaction with two lots (so there are two <b>receipt</b> store transactions):

- <b>receipt</b>, lot #<b>1</b>, Timestamp: 01 Dec 2020 <b>13:15</b>, <b>10</b> PCS, total cost: <b>120</b>;

- <b>receipt</b>, lot #<b>2</b>, Timestamp: 01 Dec 2020 <b>12:15</b>, <b>8</b> PCS, total cost: <b>96</b>.

The unit cost for both lots is <b>12</b>. Then come the following <b>issue</b> transactions:

- <b>issue</b>, lot #<b>1</b>, Timestamp: 01 Dec 2020 <b>14:28</b>, <b></b>3 PCS, total cost: 3 * 12 = <b>36</b>.

The next <b>receipt</b> transaction is only for lot #<b>1</b>:

- <b>receipt</b>, lot #<b>1</b>, Timestamp: 02 Dec 2020 <b>10:30</b>, <b>7</b> PCS, total cost: <b>98</b>;

Now lot #<b>1</b> has a unit cost of (<b>120 - 36 + 98</b>) / (<b>10 - 3 + 7</b>) =<b>13</b>, while the second lot has a unit cost of <b>12</b>.

- <b>issue</b>, lot #<b>1</b>, Timestamp: 05 Dec 2020 <b>17:20</b>, <b>4</b>PCS, total cost: 4 * 13 = <b>52</b>;

- <b>issue</b>, lot #<b>2</b>, Timestamp: 05 Dec 2020 <b>11:12</b>, <b>5</b> PCS, total cost: 5 * 12 = <b>60</b>.

## Specifying the cost explicitly

This is used when the Cost Source is set to "Document". This is the source of all <b>receipt</b> transactions, except for the ones generated by Reconciliation. For each <b>receipt</b> transaction, the cost is calculated separately and according to a formula/calculation that is specific to the current business process. The method involves calculating a number in the document currency (the cost is in only one currency). Then, this number is converted into the rest of the cost currencies (see <b>Goods Cost</b>).

Take the most basic case – procurement, the buying of goods from external suppliers. Here, the cost of the <b>receipt</b> transaction is defined by the price we bought the goods at. It is copied from the Purchase Invoices (see <b>Setting Cost When Purchasing Goods</b>). 

A more complicated example is when the cost of the goods is defined by the <b>issue</b> transaction cost of other goods available in the same enterprise company. It is not required to receive the goods from the same store. When transferring goods from one store to another, the <b>issue</b> transaction has a standard average cost. However, the goods received in the second store have to be entered with a cost equal to the one from the first store issue (a greater cost may be set if there are transport or other expenses). The same principle is applied when returning sold goods from a client or receiving back a rented asset. 

Another example is the production, where the cost of the produced products is formed by the costs of the ingredients, salary expenses, and more.

## Further reading:

- <b>Calculating Cost for Inventory Reconciliation</b>

- <b>Calculating Cost For Produced Products</b>

- <b>Calculating Cost For Returned Products</b>

- <b>Calculating Cost For Transferred Products</b>

- <b>Calculating Cost When Returning Rented Assets</b>
