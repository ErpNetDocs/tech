# Calculating Cost For Returned Products

The current article describes how the product cost is formed when returning sold products. This is a <b>receipt</b> returning. 

This process is very similar to the product transferring (see <b>Calculating Cost For Transferred Products</b>). However, there’s а difference: instead of transferring the products from one store to another in the current enterprise company, the products are taken out of the store and given to the customer. After that, the customer returns them to the same store. So, the <b>receipt</b> cost (on each row) is defined by the following formula:

<b>[receipt cost]</b> = proportional part of the <b> [issue cost]</b>

A proportional part of the <b>issue</b> cost is required as not all products can be returned after being sold. The proportion is defined by the ratio between sold and returned quantity.

<b><i>Example 1:</b></i>

A customer buys <b>10 PCS</b> on 05 Jan 2020 and a few days later returns <b>3 PCS</b>. The <b>issue</b> transaction is:

- issue, Timestamp: 05 Jan 2020 <b>11:14, 10 PCS</b>, document cost: <b>90</b>.

Then, in the <b>receipt</b> Store Order generated by the Returning Sale Order, the following is saved:

<b>3 PCS</b>, document cost: 90 * 3 / 10 = <b>27</b>

The data for the <b>issue</b> transactions is retrieved as follows: 

- The value in <i>Return For Sales Order Line</i> is taken into account - it connects us to the original line.

- For this line, the system finds all Store Orders rows referring to it.

- For each Store Order row, the respective non-voided executions are loaded (Transactions rows) - the store transactions. 

- <i>The document cost</i> is copied from the <i>Line Document Cost</i> field in the transactions rows.

There are some specific cases when the calculations from the example described above are not possible. Here, it is necessary to enter the Original Sale Orders Lines in the rows of the Returning Sales Order. Sometimes this is not possible and the original Sales Order does not exist in the system. If a company started working on @@name recently and the Original Sales Order had happened before the shift to @@name, the <i>Historical Unit Cost</i> field from the Returning Sales Order is used for the definition of the unit cost in the <b>receipt</b> transaction. 

The formula is as follows:

<b>[receipt cost] = [returned quantity] * [historical unit cost]</b>

<i><b>Example 2:</b></i>

There is a product return from a customer for <b>3 PCS</b> and the original Sales Order does not exist in @@name. The <i>Historical Unit Cost</i> field in the Returning Sales Order has to be filled in. If its value is <b>8</b>, then the <b>receipt</b> Store Order will have the following: 

<b>3 PCS</b>, document cost: 3 * 8 = <b>24</b>.

## Receipt And Issue Cost Balance

As with Store Transfers, when returning products, the quantity returned can’t be greater than the quantity sold. This is true for the original Sale document and all the Sales Orders for the products returned. Every store transaction for the Sales Orders is gathered and for each <i>Transaction Timestamp</i>, validation is performed as in the store transfers:

- The costs from all <b>issue</b> transactions with <i>Transaction Timestamp</i> smaller or equal to the current are summed up;

- The costs from all <b>receipt</b> transactions with <i>Transaction Timestamp</i> smaller or equal to the current are summed up;

- The system checks if the <b>issue</b> total is greater or equal to the <b>receipt</b> total.

For more details about this validation, see <b>Receipt And Issue Balance Validation In Store Transfers</b>.

